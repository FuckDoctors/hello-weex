os: osx
language: node_js
node_js:
  - "node"
  - "8"
branches:
  only:
    - dev
before_script:
  - npm install -g weex-toolkit
install:
  - npm install
script:
  - npm run build:docs
after_success:
  # 更新docs
  # - git init
  # - git config --global user.name "FuckDoctors"
  # - git config --global user.email "zhbchwin@163.com"
  - git add .
  - git commit -m "Updated by travis-ci at $(date)"
  - git push --force https://$DEPLOY_TOKEN@github.com/FuckDoctors/hello-weex.git dev:dev

  # 同步zhaobc.coding.me/helle-weex
  - echo -e "$SSH_KEY" > id_rsa
  - chmod 600 id_rsa
  - eval $(ssh-agent -s)
  - ssh-add id_rsa
  - rm -rf id_rsa
  - ssh -o "StrictHostKeyChecking no" git.coding.net
  - rm -rf ~/coding.net
  - mkdir ~/coding.net
  - cd ~/coding.net
  - git clone https://git.coding.net/zhaobc/zhaobc.coding.me.git
  - rm -rf ./hello-weex
  - cp -R ${TRAVIS_BUILD_DIR}/docs ./hello-weex
  - sed -i '' "s/fuckdoctors.github.io/zhaobc.coding.me/g" `grep "fuckdoctors.github.io" -rl ./hello-weex`
  - git push --force https://git.coding.net/zhaobc/zhaobc.coding.me.git master:master
